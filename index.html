
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ServiComp Online</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    thead {
      background-color: #2d6cdf;
      color: white;
    }
    th, td {
      padding: 12px 15px;
      text-align: left;
    }
    tbody tr:nth-child(even) {
      background-color: #f0f4fa;
    }
    a {
      color: #1a73e8;
      text-decoration: none;
      font-weight: 600;
    }
    .loading {
      text-align: center;
      font-size: 1.2em;
      margin-top: 40px;
    }
  </style>
</head>
<body><div style="text-align:center; margin-top: 10px; font-size: 14px;">Visitante NÂ° 25212</div>
  
<h1>ServiComp Online </h1>
<p style="text-align: center; color: #d32f2f; font-weight: 600; margin-top: -10px; margin-bottom: 20px;">
  CotizaciÃ³n vÃ¡lida por 48 horas â€” precios y stock sujetos a modificaciÃ³n sin previo aviso.
</p>

  <div class="loading">Cargando productos...</div>
  <table style="display: none;">
    <thead>
      <tr>
        <th>CÃ³digo</th>
        <th>DescripciÃ³n</th>
        <th>Detalles</th>
        <th>Stock</th>
        <th>Precio</th>
        <th>Foto</th>
      </tr>
    </thead>
    <tbody id="tabla-productos"></tbody>
  </table>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    async function cargarFiltro() {
      const res = await fetch("https://raw.githubusercontent.com/Digicodeperu/RED/main/filtro.txt");
      const txt = await res.text();
      return txt.split("\n").map(x => x.trim()).filter(x => x.length > 0);
    }

    async function cargarExcel() {
      const res = await fetch("https://raw.githubusercontent.com/Digicodeperu/RED/main/productos.xlsx");
      const data = await res.arrayBuffer();
      const workbook = XLSX.read(data, { type: "array" });
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      return XLSX.utils.sheet_to_json(sheet);
    }

    function generarLinkImagen(codigo) {
  const cod = codigo.toLowerCase();
  const sub1 = cod.substring(0, 2);
  let sub2 = cod.substring(2, 4);

  if (cod.includes("wd")) {
    sub2 = "dw";  // ExcepciÃ³n para Western Digital
  }

  return `https://imagenes.deltron.com.pe/images/productos//items/large/${sub1}/${sub2}/${cod}.jpg`;
}

function crearFila(p) {
  const tr = document.createElement("tr");
  const precio = Math.round(Number(p["PRECIO EN SOLES"] || 0));
  const linkImg = generarLinkImagen(p["CODIGO"]);
  tr.innerHTML = `
    <td>${p["MINI CODIGO"]}</td>
    <td>${p["DESCRIPCION"]}</td>
    <td>${p["DETALLES"]}</td>
    <td>${p["STOCK"]}</td>
    <td>S/ ${precio}</td>
    <td><a href="${linkImg}" target="_blank">Ver FOTO</a></td>
  `;
  return tr;
}

    async function mostrarProductos() {
      const [filtro, productos] = await Promise.all([cargarFiltro(), cargarExcel()]);
      const cuerpo = document.getElementById("tabla-productos");
      const tabla = document.querySelector("table");
      const loading = document.querySelector(".loading");

      productos
        .filter(p => filtro.includes(String(p["MINI CODIGO"]).trim()))
        .forEach(p => cuerpo.appendChild(crearFila(p)));

      tabla.style.display = "table";
      loading.style.display = "none";
    }

    mostrarProductos();
  </script>

<div id="login" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;font-family:Arial,sans-serif;">
  <h2>Acceso restringido</h2>
  <input id="claveInput" placeholder="Ingrese clave" style="padding:10px;font-size:16px;border:1px solid #ccc;border-radius:4px;">
  <button onclick="verificarClave()" style="margin-top:10px;padding:10px 20px;font-size:16px;">Entrar</button>
  <p id="errorClave" style="color:red;margin-top:10px;"></p>
</div>
<script>
  async function verificarClave() {
    const claveIngresada = document.getElementById("claveInput").value.trim();
    const respuesta = await fetch('https://raw.githubusercontent.com/Digicodeperu/RED/main/filtro.txt');
    const texto = await respuesta.text();
    const claves = texto.trim().split('\n');
    const claveCorrecta = claves[0].trim();
    if (claveIngresada === claveCorrecta) {
      document.getElementById("login").style.display = "none";
    } else {
      document.getElementById("errorClave").innerText = "Clave incorrecta.";
    }
  }
</script>



<div id="sabiasque" style="text-align: center; color: #555; font-style: italic; margin-top: 14px; font-size: 14px;">
</div>

<script>
  const curiosidades = [
    { texto: "La primera programadora de la historia fue Ada Lovelace en 1843.", autor: "Ada Lovelace" },
    { texto: "El primer virus informÃ¡tico fue creado en 1986 y se llamaba Brain.", autor: "Basit & Amjad Farooq Alvi" },
    { texto: "La contraseÃ±a mÃ¡s usada del mundo sigue siendo 123456.", autor: "NordPass Study" },
    { texto: "El primer mouse fue construido en madera en 1964.", autor: "Douglas Engelbart" },
    { texto: "El lenguaje Python fue nombrado por el grupo de comedia Monty Python.", autor: "Guido van Rossum" }
  ];

  function mostrarCuriosidad() {
    const item = curiosidades[Math.floor(Math.random() * curiosidades.length)];
    document.getElementById("sabiasque").innerHTML = `ðŸ’¡ <strong>Â¿SabÃ­as queâ€¦?</strong> ${item.texto}<br>â€” <em>${item.autor}</em>`;
  }

  window.onload = mostrarCuriosidad;
</script>

</body>
</html>
